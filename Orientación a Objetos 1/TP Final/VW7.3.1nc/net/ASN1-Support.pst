<?xml version="1.0"?><st-source><!-- Name: ASN1-SupportNotice: Copyright © 2004 Cincom Systems, Inc.  All Rights Reserved.Comment: ASN1-Support defines the 'ASN1' namespace and supplements the Smalltalk class hierarchy with the methods used in mapping ASN.1 types to VisualWorks types during encoding and decoding. Copyright: Copyright © 2004 Cincom Systems, Inc.All Rights ReservedDbIdentifier: bear73DbTrace: 49977PackageName: ASN1-SupportParcel: #('ASN1-Support')ParcelName: ASN1-SupportPrintStringCache: (73 22,lutomski)Version: 7.3 - BETADate: 4:03:24 pm November 22, 2004 --><time-stamp>From VisualWorks®, 7.3 of November 22, 2004 on November 22, 2004 at 4:03:24 pm</time-stamp><do-it>(Dialog confirm: 'You are filing-in a Parcel source file!\\While this is possible it will not have\the same effect as loading the parcel.\None of the Parcel''s prerequisites will\be loaded and none of its load actions\will be performed.\\Are you sure you want to file-in?' withCRs) ifFalse: [self error: 'Parcel file-in abandoned.  Choose terminate or close.']</do-it><name-space><name>ASN1</name><environment>Smalltalk</environment><private>false</private><imports>			private Smalltalk.*			</imports><category>ASN1</category><attributes><package>ASN1-Support</package></attributes></name-space><comment><name-space-id>ASN1</name-space-id><body>ASN1 is the namespace for constants and classes involved in the implementation of ASN.1 elements, types, parsers, encoders, and decoders.</body></comment><shared-variable><name>UniversalSET</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalSET_OF</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalOCTET_STRING</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalNULL</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalPrintableString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalBMPString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalNumericString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalREAL</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalBOOLEAN</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>PrimitiveForm</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag forms</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalObjectDescriptor</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalENUMERATED</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ConstructedForm</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag forms</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalEXTERNAL</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ConstructedSEQUENCE</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalIA5String</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalGeneralizedTime</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ApplicationClass</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag classes</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalRELATIVE_OID</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalINSTANCE_OF</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalGeneralString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ConstructedSET</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>IMPLICIT</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag types</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>BitMasksTerminal</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>bit masks</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>PrivateClass</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag classes</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalUTF8String</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalINTEGER</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalOBJECT_IDENTIFIER</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>TagMaskNumber</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag masks</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalVideotexString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalISO646String</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalCHARACTER_STRING</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalBIT_STRING</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalVisibleString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalClass</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag classes</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ContextSpecificClass</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag classes</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>TagMaskForm</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag masks</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalEMBEDDED_PDV</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>TagMaskClass</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag masks</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ConstructedSET_OF</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalT61String</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalGraphicString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalTeletexString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>EXPLICIT</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tag types</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalUniversalString</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalUTCTime</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalSEQUENCE</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>ConstructedSEQUENCE_OF</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><shared-variable><name>UniversalSEQUENCE_OF</name><environment>ASN1</environment><private>false</private><constant>false</constant><category>tags</category><attributes><package>ASN1-Support</package></attributes></shared-variable><methods><class-id>Core.Integer</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API.  This will also work if the Integer is the 'name' of an ENUMERATED."	^aMarshaler encodeINTEGER: self</body><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00000010	"ASN1.UniversalINTEGER = 2"</body></methods><methods><class-id>Core.String</class-id> <category>printing</category><body package="ASN1-Support" selector="fullPrintOn:offset:">fullPrintOn: aStream offset: offset	aStream nextPut: $'.	1 to: self size do:		[:i |		(aStream nextPut: (self at: i)) == $' ifTrue: [aStream nextPut: $']].	"embedded quotes get doubled"	aStream nextPut: $'</body></methods><methods><class-id>Core.Collection</class-id> <category>printing</category><body package="ASN1-Support" selector="fullPrintOn:offset:">fullPrintOn: aStream offset: offset	| tooMany |	tooMany := aStream position + self maxPrint.	aStream print: self class; nextPutAll: ' ('.	self do: [:element | 				aStream cr; tab: offset.				( aStream position &gt; tooMany )					ifTrue: [ aStream nextPutAll: (#etc &lt;&lt; #dialogs &gt;&gt; '...etc...') asString, ')'. ^self ].				( element respondsTo: #fullPrintOn:offset:)					ifTrue:	[ element fullPrintOn: aStream offset: offset + 1 ]					ifFalse: [ element printOn: aStream ] ]		separatedBy: [ aStream space ].	aStream nextPut: $)</body></methods><methods><class-id>Core.UndefinedObject</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	^aMarshaler encodeNULL</body><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00000101	"ASN1.UniversalNULL = 5"</body></methods><methods><class-id>Core.ByteArray</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	^aMarshaler encodeOCTET_STRING: self</body></methods><methods><class-id>Core.ByteArray</class-id> <category>printing</category><body package="ASN1-Support" selector="fullPrintOn:offset:">fullPrintOn: aStream offset: offset 	| printSize |	printSize := self size.	printSize &gt; self maxPrintElements		ifTrue: [printSize := self maxPrintElements].	aStream nextPutAll: '#['.	(1 to: printSize)		do: [:index | (self at: index) printOn: aStream]		separatedBy: [aStream space].	printSize &lt; self size ifTrue: [aStream nextPutAll: (#etc &lt;&lt; #dialogs &gt;&gt; '...etc...') asString].	aStream nextPut: $]</body></methods><methods><class-id>Core.ByteArray</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00000100	"ASN1.UniversalOCTET_STRING = 4"</body></methods><methods><class-id>Core.OrderedCollection</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	^aMarshaler encodeSEQUENCEorSEQUENCE_OF: self</body><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00110000	"ASN1.ConstructedSEQUENCE = 48"</body></methods><methods><class-id>Core.Boolean</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	^aMarshaler encodeBOOLEAN: self</body><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00000001	"ASN1.UniversalBOOLEAN = 1"</body></methods><methods><class-id>Core.ByteString</class-id> <category>marshaling -asn1</category><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	"... this is provisional and not correct, as ByteString's range include several of the ISOReg graphical sets."	^aMarshaler encodeIA5String: self</body><body package="ASN1-Support" selector="tagBER">tagBER	"... this is provisional and not correct, as ByteString's range include several of the ISOReg graphical sets."	"... avoid the namespace lookup."	^02r00010110	"ASN1.UniversalIA5String = 22"</body></methods><methods><class-id>Core.Timestamp</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="asGeneralizedTime">asGeneralizedTime	"By default, aTimestamp is marshaled as a GeneralizedTime."	^self</body><body package="ASN1-Support" selector="encodeASN1With:">encodeASN1With: aMarshaler	"... the generic, double-dispatch encoding API."	^aMarshaler encodeGeneralizedTime: self</body><body package="ASN1-Support" selector="tagBER">tagBER	"... avoid the namespace lookup."	^02r00011000	"ASN1.UniversalGeneralizedTime = 24"</body></methods><methods><class-id>Core.Object</class-id> <category>marshaling - asn1</category><body package="ASN1-Support" selector="containsAsn1Type">containsAsn1Type	^false</body></methods><do-it>"Imported Classes:"</do-it><do-it>self error: 'Attempting to file-in parcel imports.  Choose terminate or close'</do-it><class><name>Object</name><environment>Core</environment><super></super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Kernel-Objects</category><attributes><package>Kernel-Objects</package></attributes></class><class><name>Timestamp</name><environment>Core</environment><super>Core.Magnitude</super><private>false</private><indexed-type>none</indexed-type><inst-vars>year month day hour minute second millisecond </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>UIBasics-Support</category><attributes><package>UIBasics-Support</package></attributes></class><class><name>UndefinedObject</name><environment>Core</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Kernel-Objects</category><attributes><package>Kernel-Objects</package></attributes></class><class><name>Integer</name><environment>Core</environment><super>Core.Number</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Magnitude-Numbers</category><attributes><package>Magnitude-Numbers</package></attributes></class><class><name>Boolean</name><environment>Core</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Kernel-Objects</category><attributes><package>Kernel-Objects</package></attributes></class><class><name>Collection</name><environment>Core</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Collections-Abstract</category><attributes><package>Collections-Abstract</package></attributes></class><class><name>ByteArray</name><environment>Core</environment><super>Core.IntegerArray</super><private>false</private><indexed-type>bytes</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Collections-Arrayed</category><attributes><package>Collections-Arrayed</package></attributes></class><class><name>OrderedCollection</name><environment>Core</environment><super>Core.SequenceableCollection</super><private>false</private><indexed-type>objects</indexed-type><inst-vars>firstIndex lastIndex </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Collections-Sequenceable</category><attributes><package>Collections-Sequenceable</package></attributes></class><class><name>String</name><environment>Core</environment><super>Core.CharacterArray</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Collections-Text</category><attributes><package>Collections-Text</package></attributes></class><class><name>ByteString</name><environment>Core</environment><super>Core.ByteEncodedString</super><private>false</private><indexed-type>bytes</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Collections-String Support</category><attributes><package>Collections-String Support</package></attributes></class></st-source>